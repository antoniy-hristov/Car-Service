<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head th:replace="fragments :: head"></head>

<body>

<header th:replace="fragments :: header"></header>

<div class="container mt-4">

    <h3>Assigned Repairments</h3>

    <form th:action="@{/repairments}"
          th:object="${repairmentForm}"
          method="post">

        <div th:if="${repairmentForm.repairments != null}">

            <table class="table table-striped table-hover">
                <thead class="table-dark">
                <tr>
                    <th>Vehicle License Plate</th>
                    <th>Vehicle Details</th>
                    <th>Repairment Type</th>
                    <th>Status</th>
                    <th>Creation Date</th>
                    <th>Complete</th>
                </tr>
                </thead>

                <tbody>
                <tr th:each="repairment, stat : *{repairments}">

                    <!-- Hidden ID -->
                    <input type="hidden"
                           th:field="*{repairments[__${stat.index}__].id}"/>

                    <!-- License Plate -->
                    <td th:text="${repairment.vehicle.licensePlateNumber}"></td>

                    <!-- Vehicle Details -->
                    <td th:text="${repairment.vehicle.vehicleBrand}
                                 + ' '
                                 + ${repairment.vehicle.vehicleModel}
                                 + ' ('
                                 + ${repairment.vehicle.yearOfManufacture}
                                 + ')'">
                    </td>

                    <!-- Repairment Type -->
                    <td th:text="${repairment.repairmentType.typeOfRepairment}"></td>

                    <!-- Status Badge -->
                    <td>
                        <span class="badge"
                              th:classappend="${repairment.isCompleted} ? ' bg-success' : ' bg-warning'"
                              th:text="${repairment.isCompleted} ? 'Completed' : 'In Progress'">
                        </span>
                    </td>

                    <!-- Creation Date -->
                    <td th:text="${#temporals.format(repairment.creationDate, 'yyyy-MM-dd HH:mm')}"></td>

                    <!-- Checkbox -->
                    <td>
                        <input type="checkbox"
                               class="form-check-input"
                               th:field="*{repairments[__${stat.index}__].isCompleted}"/>
                    </td>

                </tr>
                </tbody>
            </table>

            <button type="submit" class="btn btn-primary">
                Submit
            </button>

        </div>

        <div th:if="${repairmentForm.repairments == null
                     or repairmentForm.repairments.isEmpty()}">
            <p class="alert alert-info">
                No repairments assigned at the moment.
            </p>
        </div>

    </form>

</div>

<footer th:replace="fragments :: footer"></footer>

</body>
</html>